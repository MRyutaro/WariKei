# WariKei: 傾斜割り勘サービス

# 概要

私の研究室では定期的に飲み会を実施している。参加者としてB4、M1、M2、先生方などがあり、それらの参加者の属性に応じて飲み会代の傾斜をつけて割り勘をしている。しかしながら、現在はエクセルを用いた手動計算であるため効率よく計算が行えないという問題がある。そこで傾斜つきの割り勘を自動で行う飲み会幹事用のWebサービスを開発する。

# 機能要件

- Reactを用いたSPAとする
- Github Pagesを利用して公開する
- データはcokkiesかlocalStorageに保存し、dbを使わずともページリロードした際にもデータが保存されるようにする
- メインはスマホで使用することを想定し、PCで使用する際には左右に余白を設けるようにすることでレスポンシブ対応を行う
- 傾斜は係数で入力する
- 支払い状況は未払い、支払い済みの2値で管理する
- 参加者1人に対して1つの属性を付与する
- 計算を行った後は適宜、参加者、属性、支払い状況の3つを以下の形式でテキストとしてコピーできるようにする
    
    ```jsx
    山田（B4）: 2000円（未払い）
    佐藤（M1）: 2400円（支払い済み）
    ...
    ```
    
- 金額の入力欄は数値のみを許容する
- 同じ名前の参加者がいた場合にはエラーを出し、重複している旨をエラー表示すること
- 何円単位で払うか変更できるようにする。例えば100円単位を選択すると下2桁が必ず0になるように最適な傾斜を自動計算する。
    - ただしver1では小数点以下を切り捨てるだけの簡単な処理を実装し、ver2以降で最適な傾斜の自動計算機能を実装する。
- データのリセットに関して、すべてのデータをリセットする処理を行う
- 参加者登録画面では、名前はテキスト入力、属性はドロップダウン入力とし、すでに登録したレコードに関しては削除ボタンを追加する。また、すでに登録したレコードの名前と属性も同じくテキスト、ドロップダウンで変更できるようにする。
- 支払い状況はチェックボックスで管理できるようにする

# コーディング規則

- コメントアウトは日本語で記載する

# 操作手順

1. 属性と初期の傾斜の登録
2. 参加者の登録
3. 合計金額の登録
4. 何円単位で払うかの登録
5. 自動計算
6. 名前、属性、金額、支払い状況を表形式で表示する
    1. 表の下には飲み屋に支払う金額、集めた合計の金額、その差額を表示する
7. 適宜支払い状況を更新する
8. データをリセットしたい場合のみデータのリセットを行う

# 傾斜の計算方法

最適な割り勘方法を自動計算する処理を関数として実装する。

その関数の引数と戻り値は以下のようにする

引数：参加者の属性とそれぞれの人数とその係数、合計金額、何円単位で支払うか

戻り値：最終的な係数、各属性が支払う金額、最終的に集まる合計金額

そして関数の概要は以下のとおりである。

何円単位で支払うかを考慮しながら、最終的に集まる合計金額が飲み屋への支払い金額と大きく異ならないようにしつつ、初期のそれぞれの係数をもとに最終的な係数を決定する。

次に自動計算のアルゴリズムについて説明する。

## Ver1

ver1では、1円単位で必ず払うようにする。ただし関数の引数としては設定できるようにしておき後から帰れるようにする。

そして単に小数点以下を四捨五入するようにする。
